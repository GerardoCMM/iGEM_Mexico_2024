import pandas as pd
import math
import sys
import os

original_stdout = sys.stdout

pos = pd.read_csv("gene_positions.tsv",sep="\t")

p_1 = ["Pn8.2617","Pn18.38","Pn8.311","Pn38.78","Pn2.1585","Pn18.31","Pn2.1119","Pn60.17","Pn6.2504","Pn28.318","Pn60.20",
"Pn60.24","Pn18.28","Pn60.27","Pn60.30","Pn2.1269","Pn2.1713","Pn5.1823","Pn6.2506","Pn3.4768","Pn6.2507","Pn6.2505",
"Pn9.1168"]

p_2 =  ["Pn2.84","Pn9.1366","Pn9.1365","Pn11.26"]

p_3 = ["Pn1.1317","Pn17.1666","Pn17.1664","Pn17.1665","Pn17.1667","Pn1.1321","Pn15.789","Pn17.1669","Pn17.1725","Pn17.1670",
"Pn1.1313","Pn1.1319","Pn23.369","Pn17.1671","Pn17.1661","Pn19.1110","Pn8.263","Pn23.375","Pn17.1724",
"Pn17.1662","Pn1.1318","Pn17.1668","Pn17.1723","Pn19.1109","Pn17.1663","Pn17.1051"]

p_4 = ["Pn7.1626","Pn4.3099","Pn2.2352","Pn3.4771","Pn2.2347","Pn3.4770","Pn3.4772"]

p_5 = ["Pn16.1198","Pn24.608","Pn16.2101","Pn24.611","Pn3.2552","Pn24.639","Pn16.1236","Pn24.642","Pn3.4306",
"Pn1.3454","Pn16.1199","Pn24.612","Pn24.640","Pn16.1237","Pn1.3560","Pn4.941","Pn17.616","Pn54.1",
"Pn8.2404","Pn24.610","Pn24.638","Pn1.479","Pn1.3228","Pn1.3512","Pn24.641","Pn16.2131","Pn17.535",
"Pn8.2226","Pn10.216","Pn36.23","Pn36.25","Pn12.2017","Pn8.2219","Pn16.182","Pn15.1623",
"Pn15.1620","Pn26.649","Pn26.648","Pn1.2579","Pn1.2585"]

p_6 = ["Pn4.3222","Pn15.99","Pn11.1118","Pn11.2681","Pn26.157","Pn30.345","Pn51.76","Pn30.381","Pn11.2682",
"Pn5.2063","Pn14.81","Pn13.2002","Pn2.2494","Pn8.236","Pn2.2647","Pn2.2654","Pn1.1880","Pn6.2605",
"Pn7.1523","Pn2.2577","Pn2.2669","Pn22.746","Pn6.2582","PN41.1","Pn2.2581","Pn22.747",
"Pn22.492","Pn2.2652","Pn2.2656","Pn2.2671"]

p_7 = ["Pn2.2377","Pn1.1024","Pn1.1022","Pn1.1012","Pn1.994","Pn15.572","Pn24.75","Pn1.988","Pn1.977","Pn23.264","Pn1.1001",
"Pn1.281","Pn1.958","Pn1.997","Pn11.943","Pn15.554","Pn1.939","Pn9.866","Pn1.938","Pn15.581","Pn23.292","Pn1.963",
"Pn1.949","Pn6.3450","Pn15.578","Pn1.944","Pn15.591","Pn1.946","Pn9.858","Pn1.967","Pn15.582","Pn1.951","Pn1.943",
"Pn2.2365","Pn1.989","Pn1.282","Pn23.262","Pn1.1008","Pn15.579","Pn2.2371","Pn1.961","Pn1.1020","Pn6.3467",
"Pn23.298","Pn23.258","Pn1.982","Pn23.297","Pn22.770","Pn1.1009","Pn15.564","Pn22.516","Pn1.1748","Pn15.565",
"Pn1.1017","Pn1.298","Pn11.410","Pn2.2368","Pn1.1018","Pn1.975","Pn15.593","Pn1.1441","Pn1.1189","Pn14.1197",
"Pn15.559","Pn23.286","Pn1.1028","Pn16.1023","Pn1.993","Pn1.957","Pn23.279","Pn4.810","Pn2.2373","Pn1.1029",
"Pn24.76","Pn1.954","Pn15.556","Pn1.979","Pn6.3479","Pn15.577","Pn14.1198","Pn23.276","Pn1.996","Pn1.649",
"Pn9.869","Pn1.999","Pn1.1002","Pn1.966","Pn1.964","Pn1.972","Pn1.940","Pn11.301","Pn15.574","Pn15.589","Pn1.974",
"Pn15.560","Pn23.257","Pn1.1013","Pn11.187","Pn23.263","Pn15.568","Pn1.1436","Pn15.567","Pn1.971","Pn8.260",
"Pn1.965","Pn23.281","Pn23.290","Pn15.576","Pn15.586","Pn1.1016","Pn23.282","Pn9.859","Pn1.981","Pn2.2740",
"Pn1.942","Pn1.959","Pn1.983","Pn23.275","Pn11.941","Pn9.855","Pn1.1003","Pn1.1014","Pn22.519","Pn1.998",
"Pn23.267","Pn1.1021","Pn11.942","Pn16.1933","Pn1.1005","Pn1.1023","Pn1.1011","Pn1.995","Pn1.970",
"Pn23.269","Pn1.945","Pn1.973","Pn15.558","Pn1.1025","Pn1.990","Pn1.968","Pn1.991","Pn9.854","Pn23.261","Pn1.969",
"Pn1.1437","Pn1.1015","Pn6.3413","Pn1.985","Pn11.411","Pn11.940","Pn1.952","Pn23.268","Pn11.184","Pn11.186",
"Pn23.272","Pn1.955","Pn1.299","Pn23.293","Pn15.553","Pn15.561","Pn1.986","Pn1.1007","Pn1.1006","Pn15.592",
"Pn1.947","Pn1.1438","Pn1.1027","Pn15.552","Pn15.580","Pn1.956","Pn23.285","Pn23.296","Pn23.259","Pn1.941",
"Pn23.284","Pn23.271","Pn15.573","Pn23.265","Pn23.295","Pn23.277","Pn23.270","Pn22.523","Pn23.280","Pn23.273"]

p_8 = ["Pn6.2477","Pn1.2478","Pn3.1635","Pn8.2854","Pn6.1174","Pn40.54","Pn40.58","Pn5.218","Pn17.454","Pn40.52","Pn5.221",
"Pn10.1304","Pn1.345","Pn40.53","Pn5.214","Pn17.1690","Pn17.1636","Pn8.2280","Pn17.1637","Pn23.251","Pn17.1638",
"Pn3.2102","Pn4.408","Pn8.1898","Pn1.2981","Pn8.2067","Pn4.405","Pn22.221","Pn4.412","Pn11.952","Pn11.175",
"Pn1.1758","Pn1.2980","Pn11.172","Pn7.1869","Pn11.950","Pn11.177","Pn1.2978","Pn1.1762","Pn24.505","Pn7.2186",
"Pn8.1092","Pn6.379","Pn10.850","Pn1.1521","Pn2.2385","Pn19.1153","Pn12.1188","Pn15.462","Pn16.734","Pn16.738",
"Pn33.144","Pn6.1606","Pn17.1263","Pn14.1359","Pn15.468","Pn13.1351","Pn9.360","Pn11.2248","Pn11.2279","Pn15.1636",
"Pn1.1529","Pn18.1030","Pn3.4227","Pn19.981","Pn5.876","Pn15.1030","Pn5.3211","Pn14.1358","Pn8.1884","Pn26.607",
"Pn8.288","Pn1.3065","Pn26.632","Pn24.507","Pn15.1716","Pn24.506","Pn1.1523","Pn19.989","Pn1.1216","Pn14.1361",
"Pn15.463","Pn19.985","Pn23.165","Pn15.1032","Pn12.1559","Pn3.2205","Pn23.130","Pn3.2206","Pn15.644","Pn15.1031",
"Pn1.227","Pn1.3303","Pn1.1534","Pn7.2061","Pn10.852","Pn14.1364","Pn16.733","Pn19.393","Pn44.129","Pn3.435",
"Pn33.142","Pn5.1238","Pn3.220","Pn3.2432","Pn4.840","Pn10.918","Pn18.1029","Pn19.991","Pn6.3929","Pn18.1033",
"Pn11.13","Pn5.2315","Pn15.461","Pn3.4066","Pn1.132","Pn5.874","Pn3.2433","Pn2.729","Pn14.296","Pn19.986",
"Pn12.259","Pn5.2276","Pn1.1528","Pn8.487","Pn6.1604","Pn19.251","Pn14.862","Pn1.1532","Pn11.2221","Pn17.1441",
"Pn55.27","Pn10.921","Pn12.1192","Pn17.1283","Pn2.2391","Pn15.26","Pn10.919","Pn1.3375","Pn15.421",
"Pn19.992","Pn19.1149","Pn12.1813","Pn8.486","Pn14.1363","Pn12.1558","Pn17.1171","Pn17.1278","Pn1.1215","Pn8.289",
"Pn3.433","Pn14.1354","Pn5.1248","Pn7.2060","Pn3.434","Pn6.2330","Pn17.1172","Pn19.250","Pn10.851","Pn6.2521",
"Pn1.1527","Pn5.2832","Pn14.1356","Pn33.145","Pn15.1029"]

enzymes = [p_1,p_2,p_3,p_4,p_5,p_6,p_7,p_8]

color = "color=set1-8-qual-"

origin = []

for i,enzyme in enumerate(enzymes):
    for gene in enzyme[0:1]:
            for j,genename in enumerate(list(pos.loc[:,"name"])):
                if gene==genename:
                    origin.append(f"{pos.loc[j,'Chromosome']}\t{int(pos.loc[j,'init'])}\t{int(pos.loc[j,'end'])}")


with open("links.txt", 'w') as f:
    sys.stdout = f # Change the standard output to the file we created.
    for i,enzyme in enumerate(enzymes):
        for gene in enzyme[1:]:
            for j,genename in enumerate(list(pos.loc[:,"name"])):
                if gene==genename:
                    print(f"{origin[i]}\t{pos.loc[j,'Chromosome']}\t{int(pos.loc[j,'init'])}\t{int(pos.loc[j,'end'])}\t{color}{8-i}")

    sys.stdout = original_stdout # Reset the standard output to its original value